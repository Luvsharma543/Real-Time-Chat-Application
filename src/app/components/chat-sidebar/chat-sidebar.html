<!-- <div class="p-4">
  <div class="flex items-center justify-between w-full bg-white z-10 sticky top-0 p-1 ">
     <div class="flex items-center">
          <img class="h-15 w-15 rounded-full object-cover border-gray-100 border-2" 
          [src]="'https://localhost:5000'+this.authService.currentLoggedUser?.profileImage" alt="">
         <div class="font-medium ml-2 text-gray-500">
                  {{authService.currentLoggedUser?.fullName|titlecase}}
         </div>
     </div>
     <button mat-icon-button [matMenuTriggerFor]="menu">
       <mat-icon>more_vert</mat-icon>
     </button>
     <mat-menu #menu="matMenu"> 
      <button (click)="logout()" mat-menu-item>
        <mat-icon>logout</mat-icon>
        <span>Logout</span>
      </button>
     </mat-menu>
  </div>
  <div class="relative flex mt-4 items-center gap-2 justify-between">
     <input type="text"  [(ngModel)]="search" (ngModelChange)="onSearchFilter()" placeholder="Search" class=" bg-slate-100 border-1 focus:ring-1
       focus:ring-slate-100 focus:outline-none w-full mb-3 border-slate-200 p-1 pl-10 text-slate-500
         font-normal px-3 rounded-md">
         <mat-icon class="absolute text-gray-400 left-2 top-1 pr-3">
           search
         </mat-icon>
  </div>
  <div class="py-1 overflow-y-auto scroll-smooth">
     @for (user of chatService.onlineUserSearch(); track user)
     {    
          <div (click)="openChatWindow(user)" class="flex items-center gap-2 py-2 hover:bg-slate-200 cursor-pointer">
              <img [src]="'https://localhost:5000'+user.profilePicture" class="h-10 w-10 rounded-full object-cover" alt="">
              <div>
                <span class="text-base text-gray-600 font-normal">{{user!.fullName|titlecase}}</span>
                <p class="text-xs text-gray-400">
                  
                  {{user.unreadCount? user.unreadCount+'new message':''}}

                </p>
                @if(user.isTyping)
                {
                  <app-typing-indicator/>
                }
                @else {

                }
              </div>
                  @if(user.isOnline)
                  {
                       <div class="ml-auto font-medium text-xs">
                           <div class="bg-green-700 w-2 h-2 rounded-full"></div>
                       </div>
                  }
                  @else{
                    <div class="bg-green-100 w-2 h-2 rounded-full"></div>
                  }
          </div>
        }
  </div>
</div> -->


<div class="h-full bg-gradient-to-b from-white to-slate-50 border-r border-slate-200/50">
  <!-- Modern Header Section -->
  <div class="flex items-center justify-between w-full bg-white/90 backdrop-blur-sm z-10 sticky top-0 p-6 border-b border-slate-200/50 shadow-sm">
     <div class="flex items-center space-x-4">
          <!-- User Profile Image with Status -->
          <div class="relative">
            <img class="h-12 w-12 rounded-full object-cover ring-2 ring-blue-100 shadow-md transition-all duration-200 hover:ring-blue-200" 
                 [src]="'https://localhost:5000'+this.authService.currentLoggedUser?.profileImage" alt="">
            <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 border-2 border-white rounded-full"></div>
          </div>
          
          <!-- User Info -->
          <div class="flex flex-col">
            <h2 class="font-semibold text-slate-800 text-lg leading-tight">
              {{authService.currentLoggedUser?.fullName|titlecase}}
            </h2>
            <p class="text-sm text-slate-500">Active now</p>
          </div>
     </div>
     
     <!-- Menu Button -->
     <button mat-icon-button [matMenuTriggerFor]="menu" 
             class="hover:bg-slate-100 transition-colors duration-200 rounded-full">
       <mat-icon class="text-slate-600">more_vert</mat-icon>
     </button>
     
     <mat-menu #menu="matMenu" class="modern-menu"> 
      <button (click)="logout()" mat-menu-item class="flex items-center space-x-3 px-4 py-3 hover:bg-red-50 transition-colors">
        <mat-icon class="text-red-500">logout</mat-icon>
        <span class="text-slate-700">Logout</span>
      </button>
     </mat-menu>
  </div>
  
  <!-- Modern Search Section -->
  <div class="px-6 py-4">
     <div class="relative">
        <div class="absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none">
          <mat-icon class="text-slate-400 text-xl">search</mat-icon>
        </div>
        <input type="text"  
               [(ngModel)]="search" 
               (ngModelChange)="onSearchFilter()" 
               placeholder="Search conversations..." 
               class="w-full bg-slate-100 hover:bg-slate-50 focus:bg-white border border-transparent focus:border-blue-200 focus:ring-2 focus:ring-blue-100 focus:outline-none pl-12 pr-4 py-3 text-slate-700 placeholder-slate-400 rounded-xl transition-all duration-200 font-medium">
     </div>
  </div>
  
  <!-- Chat List Section -->
  <div class="px-3 pb-4 overflow-y-auto scroll-smooth">
     <!-- Section Header -->
     <div class="px-3 mb-3">
        <h3 class="text-xs font-semibold text-slate-500 uppercase tracking-wider">Recent Chats</h3>
     </div>
     
     @for (user of chatService.onlineUserSearch(); track user) {  


      
          <div (click)="openChatWindow(user)" 
               class="flex items-center space-x-4 p-4 mx-1 rounded-xl hover:bg-slate-100 cursor-pointer transition-all duration-200 group hover:shadow-sm">
              
              <!-- User Avatar with Online Status -->
              <div class="relative flex-shrink-0">
                <img [src]="'https://localhost:5000'+user.profilePicture" 
                     class="h-12 w-12 rounded-full object-cover ring-2 ring-transparent group-hover:ring-blue-100 transition-all duration-200" 
                     alt="">
                
                <!-- Online/Offline Status Indicator -->
                @if(user.isOnline) {
                  <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 border-2 border-white rounded-full animate-pulse"></div>
                } @else {
                  <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-slate-300 border-2 border-white rounded-full"></div>
                }
              </div>
              
              <!-- User Info -->
              <div class="flex-1 min-w-0">
                <div class="flex items-center justify-between mb-1">
                  <h4 class="text-slate-800 font-semibold text-base truncate group-hover:text-slate-900 transition-colors">
                    {{user!.fullName|titlecase}}
                  </h4>
                  
                  <!-- Unread Badge -->
                  @if(user.unreadCount) {
                    <span class="inline-flex items-center justify-center min-w-5 h-5 px-2 bg-blue-500 text-white text-xs font-bold rounded-full animate-pulse">
                      {{user.unreadCount}}
                    </span>
                  }
                </div>
                
                <!-- Status Text -->
                <div class="flex items-center space-x-2">
                  @if(user.isTyping) {
                    <div class="flex items-center space-x-1">
                      <div class="flex space-x-1">
                        <div class="w-1 h-1 bg-blue-500 rounded-full animate-bounce"></div>
                        <div class="w-1 h-1 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-1 h-1 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                      </div>
                      <span class="text-xs text-blue-600 font-medium">typing...</span>
                    </div>
                  } @else if(user.unreadCount) {
                    <p class="text-xs text-slate-600 font-medium">
                      {{user.unreadCount}} new message{{user.unreadCount > 1 ? 's' : ''}}
                    </p>
                  } @else {
                    <p class="text-xs text-slate-500">
                      @if(user.isOnline) {
                        <span class="flex items-center space-x-1">
                          <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                          <span>Online</span>
                        </span>
                      } @else {
                        <span>Last seen recently</span>
                      }
                    </p>
                  }
                </div>
              </div>
              
              <!-- Chevron Icon -->
              <div class="opacity-0 group-hover:opacity-100 transition-opacity duration-200">
                <mat-icon class="text-slate-400 text-lg">chevron_right</mat-icon>
              </div>
          </div>
        
     }
     
     <!-- Empty State -->
     @if(chatService.onlineUserSearch().length === 0) {
       <div class="flex flex-col items-center justify-center py-12 px-4">
         <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4">
           <mat-icon class="text-slate-400 text-2xl">chat_bubble_outline</mat-icon>
         </div>
         <h3 class="text-slate-600 font-medium mb-2">No conversations yet</h3>
         <p class="text-slate-500 text-sm text-center leading-relaxed">Start a new conversation to connect with your friends</p>
       </div>
     }
  </div>
</div>